# CMD vs ENTRYPOINT: коротко и по делу

## Краткое правило
- Если CMD/ENTRYPOINT не заданы — используются значения базового образа (см. `docker history`).
- Допустимо указать только одно либо оба. Альтернатива — задать на `docker run` или в манифесте k8s.
- Ubuntu пример по умолчанию:
  ```dockerfile
  ENTRYPOINT ["/bin/sh", "-c"]
  CMD ["bash"]
  ```

## Как переопределяется при запуске
- CMD перезаписывается аргументом:
  ```bash
  docker run --rm test_entry_cmd_2 ping netology.ru
  # Было CMD ["/bin/ping", "ya.ru"] → стало "ping netology.ru"
  ```
- ENTRYPOINT требует `--entrypoint`, иначе аргументы лишь дополняют:
  ```bash
  docker run --rm test_entry_cmd_1 netology.ru
  # Получилось: /bin/ping ya.ru netology.ru (ошибка)
  docker run --rm --entrypoint ping test_entry_cmd_1 netology.ru
  # Только здесь ENTRYPOINT заменён
  ```

## Когда что выбирать
- CMD — гибкость, "швейцарский нож" (ansible+terraform+kubectl+ping+curl...).
- ENTRYPOINT — фиксированное приложение/сервис, чтобы не запустили что-то иное.

## Паттерн ENTRYPOINT + CMD (рекомендуется)
- ENTRYPOINT задаёт бинарь, CMD — разумные аргументы по умолчанию, которые легко поменять.

Примеры:
- Web:
  ```dockerfile
  ENTRYPOINT ["gunicorn", "config.wsgi"]
  CMD ["-w", "4"]
  ```
  По умолчанию `gunicorn config.wsgi -w 4`, переопределение: `docker run app -w 44`.

- MySQL:
  ```dockerfile
  ENTRYPOINT ["mysqld"]
  CMD ["--default-authentication-plugin=caching_sha2_password"]
  ```
  Переопределение: `docker run db --default-authentication-plugin=mysql_native_password`.

- Python:
  ```dockerfile
  ENTRYPOINT ["python", "app.py"]
  CMD ["--env", "development", "--host", "0.0.0.0", "--port", "8000"]
  ```
  Переопределение: `docker run app --port 9000 --env production`.

## Запомнить
- ENTRYPOINT отвечает на **что запускаем**.
- CMD отвечает на **с какими параметрами**.

